#!/usr/bin/env python3
"""
qwen ping - Test Qwen connection status
"""

import sys
import os
from pathlib import Path

# Add the lib directory to the path
script_dir = Path(__file__).resolve().parent.parent
lib_dir = script_dir / "lib"
sys.path.insert(0, str(lib_dir))

try:
    from qwen_comm import QwenCommunicator
    comm = QwenCommunicator()
    success, message = comm.ping(display=False)
    print(message)
    sys.exit(0 if success else 1)
except RuntimeError as e:
    # If there's no active session, that's a specific error we can handle
    error_msg = str(e)
    print(error_msg)
    # Check if it's the "no active session" error
    if "No active Qwen session found" in error_msg:
        print("üí° To start a Qwen session, run: ccb qwen (inside tmux or WezTerm)")
    sys.exit(1)
except ImportError as e:
    print(f"‚ùå Import error: {e}")
    sys.exit(1)
except Exception as e:
    print(f"‚ùå Error: {e}")
    sys.exit(1)